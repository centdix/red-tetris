'use strict';function cov_kgorlvdek(){var path="/Users/farhad/Desktop/red-tetrisv2/src/server/Game.js";var hash="62dc19739dd68990bb671b9b0ad8e0307452c089";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/farhad/Desktop/red-tetrisv2/src/server/Game.js",statementMap:{"0":{start:{line:3,column:14},end:{line:3,column:35}},"1":{start:{line:4,column:15},end:{line:4,column:37}},"2":{start:{line:5,column:11},end:{line:5,column:31}},"3":{start:{line:9,column:20},end:{line:9,column:61}},"4":{start:{line:10,column:2},end:{line:25,column:3}},"5":{start:{line:12,column:4},end:{line:12,column:15}},"6":{start:{line:14,column:4},end:{line:14,column:15}},"7":{start:{line:16,column:4},end:{line:16,column:15}},"8":{start:{line:18,column:4},end:{line:18,column:15}},"9":{start:{line:20,column:4},end:{line:20,column:15}},"10":{start:{line:22,column:4},end:{line:22,column:15}},"11":{start:{line:24,column:4},end:{line:24,column:15}},"12":{start:{line:29,column:2},end:{line:29,column:15}},"13":{start:{line:30,column:2},end:{line:30,column:21}},"14":{start:{line:31,column:2},end:{line:31,column:19}},"15":{start:{line:32,column:2},end:{line:32,column:19}},"16":{start:{line:33,column:2},end:{line:33,column:20}},"17":{start:{line:34,column:2},end:{line:34,column:27}},"18":{start:{line:35,column:2},end:{line:35,column:25}},"19":{start:{line:36,column:2},end:{line:36,column:26}},"20":{start:{line:37,column:2},end:{line:37,column:21}},"21":{start:{line:38,column:2},end:{line:38,column:23}},"22":{start:{line:42,column:2},end:{line:43,column:46}},"23":{start:{line:43,column:3},end:{line:43,column:46}},"24":{start:{line:44,column:2},end:{line:44,column:28}},"25":{start:{line:48,column:2},end:{line:49,column:46}},"26":{start:{line:49,column:3},end:{line:49,column:46}},"27":{start:{line:51,column:16},end:{line:51,column:44}},"28":{start:{line:52,column:2},end:{line:53,column:35}},"29":{start:{line:53,column:3},end:{line:53,column:35}},"30":{start:{line:54,column:2},end:{line:54,column:32}},"31":{start:{line:55,column:2},end:{line:57,column:3}},"32":{start:{line:56,column:3},end:{line:56,column:32}},"33":{start:{line:61,column:2},end:{line:61,column:26}},"34":{start:{line:62,column:2},end:{line:62,column:50}},"35":{start:{line:63,column:2},end:{line:63,column:50}},"36":{start:{line:64,column:2},end:{line:64,column:30}},"37":{start:{line:65,column:2},end:{line:69,column:5}},"38":{start:{line:66,column:3},end:{line:66,column:24}},"39":{start:{line:67,column:15},end:{line:67,column:33}},"40":{start:{line:68,column:3},end:{line:68,column:77}},"41":{start:{line:70,column:2},end:{line:73,column:10}},"42":{start:{line:71,column:3},end:{line:71,column:22}},"43":{start:{line:72,column:3},end:{line:72,column:20}},"44":{start:{line:77,column:14},end:{line:77,column:33}},"45":{start:{line:78,column:2},end:{line:93,column:5}},"46":{start:{line:79,column:3},end:{line:92,column:4}},"47":{start:{line:80,column:4},end:{line:80,column:12}},"48":{start:{line:82,column:4},end:{line:82,column:21}},"49":{start:{line:83,column:4},end:{line:91,column:5}},"50":{start:{line:84,column:17},end:{line:84,column:35}},"51":{start:{line:85,column:5},end:{line:89,column:6}},"52":{start:{line:86,column:6},end:{line:86,column:62}},"53":{start:{line:87,column:6},end:{line:87,column:62}},"54":{start:{line:88,column:6},end:{line:88,column:42}},"55":{start:{line:90,column:5},end:{line:90,column:79}},"56":{start:{line:94,column:2},end:{line:107,column:3}},"57":{start:{line:95,column:3},end:{line:95,column:15}},"58":{start:{line:96,column:3},end:{line:96,column:20}},"59":{start:{line:98,column:7},end:{line:107,column:3}},"60":{start:{line:99,column:16},end:{line:99,column:20}},"61":{start:{line:100,column:3},end:{line:103,column:4}},"62":{start:{line:100,column:16},end:{line:100,column:17}},"63":{start:{line:101,column:4},end:{line:102,column:30}},"64":{start:{line:102,column:5},end:{line:102,column:30}},"65":{start:{line:104,column:3},end:{line:104,column:24}},"66":{start:{line:105,column:3},end:{line:105,column:15}},"67":{start:{line:106,column:3},end:{line:106,column:20}},"68":{start:{line:111,column:2},end:{line:111,column:27}},"69":{start:{line:112,column:2},end:{line:112,column:31}},"70":{start:{line:113,column:2},end:{line:113,column:23}},"71":{start:{line:117,column:2},end:{line:117,column:58}},"72":{start:{line:121,column:2},end:{line:128,column:4}},"73":{start:{line:132,column:0},end:{line:132,column:22}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:1},end:{line:8,column:2}},loc:{start:{line:8,column:28},end:{line:26,column:2}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:28,column:1},end:{line:28,column:2}},loc:{start:{line:28,column:36},end:{line:39,column:2}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:41,column:1},end:{line:41,column:2}},loc:{start:{line:41,column:19},end:{line:45,column:2}},line:41},"3":{name:"(anonymous_3)",decl:{start:{line:47,column:1},end:{line:47,column:2}},loc:{start:{line:47,column:22},end:{line:58,column:2}},line:47},"4":{name:"(anonymous_4)",decl:{start:{line:60,column:1},end:{line:60,column:2}},loc:{start:{line:60,column:9},end:{line:74,column:2}},line:60},"5":{name:"(anonymous_5)",decl:{start:{line:65,column:23},end:{line:65,column:24}},loc:{start:{line:65,column:30},end:{line:69,column:3}},line:65},"6":{name:"(anonymous_6)",decl:{start:{line:70,column:30},end:{line:70,column:31}},loc:{start:{line:70,column:36},end:{line:73,column:3}},line:70},"7":{name:"(anonymous_7)",decl:{start:{line:76,column:1},end:{line:76,column:2}},loc:{start:{line:76,column:15},end:{line:108,column:2}},line:76},"8":{name:"(anonymous_8)",decl:{start:{line:78,column:23},end:{line:78,column:24}},loc:{start:{line:78,column:30},end:{line:93,column:3}},line:78},"9":{name:"(anonymous_9)",decl:{start:{line:110,column:1},end:{line:110,column:2}},loc:{start:{line:110,column:8},end:{line:114,column:2}},line:110},"10":{name:"(anonymous_10)",decl:{start:{line:116,column:1},end:{line:116,column:2}},loc:{start:{line:116,column:13},end:{line:118,column:2}},line:116},"11":{name:"(anonymous_11)",decl:{start:{line:120,column:1},end:{line:120,column:2}},loc:{start:{line:120,column:11},end:{line:129,column:2}},line:120}},branchMap:{"0":{loc:{start:{line:10,column:2},end:{line:25,column:3}},type:"switch",locations:[{start:{line:11,column:3},end:{line:12,column:15}},{start:{line:13,column:3},end:{line:14,column:15}},{start:{line:15,column:3},end:{line:16,column:15}},{start:{line:17,column:3},end:{line:18,column:15}},{start:{line:19,column:3},end:{line:20,column:15}},{start:{line:21,column:3},end:{line:22,column:15}},{start:{line:23,column:3},end:{line:24,column:15}}],line:10},"1":{loc:{start:{line:42,column:2},end:{line:43,column:46}},type:"if",locations:[{start:{line:42,column:2},end:{line:43,column:46}},{start:{line:42,column:2},end:{line:43,column:46}}],line:42},"2":{loc:{start:{line:48,column:2},end:{line:49,column:46}},type:"if",locations:[{start:{line:48,column:2},end:{line:49,column:46}},{start:{line:48,column:2},end:{line:49,column:46}}],line:48},"3":{loc:{start:{line:52,column:2},end:{line:53,column:35}},type:"if",locations:[{start:{line:52,column:2},end:{line:53,column:35}},{start:{line:52,column:2},end:{line:53,column:35}}],line:52},"4":{loc:{start:{line:55,column:2},end:{line:57,column:3}},type:"if",locations:[{start:{line:55,column:2},end:{line:57,column:3}},{start:{line:55,column:2},end:{line:57,column:3}}],line:55},"5":{loc:{start:{line:79,column:3},end:{line:92,column:4}},type:"if",locations:[{start:{line:79,column:3},end:{line:92,column:4}},{start:{line:79,column:3},end:{line:92,column:4}}],line:79},"6":{loc:{start:{line:83,column:4},end:{line:91,column:5}},type:"if",locations:[{start:{line:83,column:4},end:{line:91,column:5}},{start:{line:83,column:4},end:{line:91,column:5}}],line:83},"7":{loc:{start:{line:85,column:5},end:{line:89,column:6}},type:"if",locations:[{start:{line:85,column:5},end:{line:89,column:6}},{start:{line:85,column:5},end:{line:89,column:6}}],line:85},"8":{loc:{start:{line:94,column:2},end:{line:107,column:3}},type:"if",locations:[{start:{line:94,column:2},end:{line:107,column:3}},{start:{line:94,column:2},end:{line:107,column:3}}],line:94},"9":{loc:{start:{line:94,column:6},end:{line:94,column:76}},type:"binary-expr",locations:[{start:{line:94,column:6},end:{line:94,column:31}},{start:{line:94,column:35},end:{line:94,column:76}}],line:94},"10":{loc:{start:{line:98,column:7},end:{line:107,column:3}},type:"if",locations:[{start:{line:98,column:7},end:{line:107,column:3}},{start:{line:98,column:7},end:{line:107,column:3}}],line:98},"11":{loc:{start:{line:98,column:11},end:{line:98,column:49}},type:"binary-expr",locations:[{start:{line:98,column:11},end:{line:98,column:34}},{start:{line:98,column:38},end:{line:98,column:49}}],line:98},"12":{loc:{start:{line:101,column:4},end:{line:102,column:30}},type:"if",locations:[{start:{line:101,column:4},end:{line:102,column:30}},{start:{line:101,column:4},end:{line:102,column:30}}],line:101}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0,0,0,0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"62dc19739dd68990bb671b9b0ad8e0307452c089"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_kgorlvdek=function(){return actualCoverage;};}return actualCoverage;}cov_kgorlvdek();const Piece=(cov_kgorlvdek().s[0]++,require('./Piece.js'));const Player=(cov_kgorlvdek().s[1]++,require('./Player.js'));const io=(cov_kgorlvdek().s[2]++,require('socket.io'));class Game{static generatePieceType(){cov_kgorlvdek().f[0]++;const rdmNumber=(cov_kgorlvdek().s[3]++,Math.floor(Math.random()*Math.floor(7)));cov_kgorlvdek().s[4]++;switch(rdmNumber){case 0:cov_kgorlvdek().b[0][0]++;cov_kgorlvdek().s[5]++;return'I';case 1:cov_kgorlvdek().b[0][1]++;cov_kgorlvdek().s[6]++;return'O';case 2:cov_kgorlvdek().b[0][2]++;cov_kgorlvdek().s[7]++;return'J';case 3:cov_kgorlvdek().b[0][3]++;cov_kgorlvdek().s[8]++;return'S';case 4:cov_kgorlvdek().b[0][4]++;cov_kgorlvdek().s[9]++;return'Z';case 5:cov_kgorlvdek().b[0][5]++;cov_kgorlvdek().s[10]++;return'L';case 6:cov_kgorlvdek().b[0][6]++;cov_kgorlvdek().s[11]++;return'T';}}constructor(io,owner,room,mode){cov_kgorlvdek().f[1]++;cov_kgorlvdek().s[12]++;this.io=io;cov_kgorlvdek().s[13]++;this.owner=owner;cov_kgorlvdek().s[14]++;this.room=room;cov_kgorlvdek().s[15]++;this.mode=mode;cov_kgorlvdek().s[16]++;this.players=[];cov_kgorlvdek().s[17]++;this.players.push(owner);cov_kgorlvdek().s[18]++;this.typesInQueue=[];cov_kgorlvdek().s[19]++;this.status='standby';cov_kgorlvdek().s[20]++;this.winner=null;cov_kgorlvdek().s[21]++;this.interval=null;}addPlayer(player){cov_kgorlvdek().f[2]++;cov_kgorlvdek().s[22]++;if(player instanceof Player===false){cov_kgorlvdek().b[1][0]++;cov_kgorlvdek().s[23]++;throw Error('argument should be a Player');}else{cov_kgorlvdek().b[1][1]++;}cov_kgorlvdek().s[24]++;this.players.push(player);}removePlayer(player){cov_kgorlvdek().f[3]++;cov_kgorlvdek().s[25]++;if(player instanceof Player===false){cov_kgorlvdek().b[2][0]++;cov_kgorlvdek().s[26]++;throw Error('argument should be a Player');}else{cov_kgorlvdek().b[2][1]++;}const index=(cov_kgorlvdek().s[27]++,this.players.indexOf(player));cov_kgorlvdek().s[28]++;if(index===-1){cov_kgorlvdek().b[3][0]++;cov_kgorlvdek().s[29]++;throw Error('player not found');}else{cov_kgorlvdek().b[3][1]++;}cov_kgorlvdek().s[30]++;this.players.splice(index,1);cov_kgorlvdek().s[31]++;if(player.id===this.owner.id){cov_kgorlvdek().b[4][0]++;cov_kgorlvdek().s[32]++;this.owner=this.players[0];}else{cov_kgorlvdek().b[4][1]++;}}start(){cov_kgorlvdek().f[4]++;cov_kgorlvdek().s[33]++;this.status='running';cov_kgorlvdek().s[34]++;this.typesInQueue[0]=Game.generatePieceType();cov_kgorlvdek().s[35]++;this.typesInQueue[1]=Game.generatePieceType();cov_kgorlvdek().s[36]++;this.typesInQueue[2]=null;cov_kgorlvdek().s[37]++;this.players.forEach(p=>{cov_kgorlvdek().f[5]++;cov_kgorlvdek().s[38]++;p.board.init(10,20);let index=(cov_kgorlvdek().s[39]++,p.board.pieceIndex);cov_kgorlvdek().s[40]++;p.board.setPieces(this.typesInQueue[index],this.typesInQueue[index+1]);});cov_kgorlvdek().s[41]++;this.interval=setInterval(()=>{cov_kgorlvdek().f[6]++;cov_kgorlvdek().s[42]++;this.updateState();cov_kgorlvdek().s[43]++;this.sendState();},200);}updateState(){cov_kgorlvdek().f[7]++;let alive=(cov_kgorlvdek().s[44]++,this.players.length);cov_kgorlvdek().s[45]++;this.players.forEach(p=>{cov_kgorlvdek().f[8]++;cov_kgorlvdek().s[46]++;if(p.board.status==='filled'){cov_kgorlvdek().b[5][0]++;cov_kgorlvdek().s[47]++;alive--;}else{cov_kgorlvdek().b[5][1]++;cov_kgorlvdek().s[48]++;p.board.update();cov_kgorlvdek().s[49]++;if(p.board.needPiece){cov_kgorlvdek().b[6][0]++;let index=(cov_kgorlvdek().s[50]++,p.board.pieceIndex);cov_kgorlvdek().s[51]++;if(this.typesInQueue[index+1]===null){cov_kgorlvdek().b[7][0]++;cov_kgorlvdek().s[52]++;this.typesInQueue[index+1]=Game.generatePieceType();cov_kgorlvdek().s[53]++;this.typesInQueue[index+2]=Game.generatePieceType();cov_kgorlvdek().s[54]++;this.typesInQueue[index+3]=null;}else{cov_kgorlvdek().b[7][1]++;}cov_kgorlvdek().s[55]++;p.board.setPieces(this.typesInQueue[index],this.typesInQueue[index+1]);}else{cov_kgorlvdek().b[6][1]++;}}});cov_kgorlvdek().s[56]++;if((cov_kgorlvdek().b[9][0]++,this.players.length===1)&&(cov_kgorlvdek().b[9][1]++,this.players[0].board.status==='filled')){cov_kgorlvdek().b[8][0]++;cov_kgorlvdek().s[57]++;this.stop();cov_kgorlvdek().s[58]++;this.sendState();}else{cov_kgorlvdek().b[8][1]++;cov_kgorlvdek().s[59]++;if((cov_kgorlvdek().b[11][0]++,this.players.length>1)&&(cov_kgorlvdek().b[11][1]++,alive===1)){cov_kgorlvdek().b[10][0]++;let winner=(cov_kgorlvdek().s[60]++,null);cov_kgorlvdek().s[61]++;for(let i=(cov_kgorlvdek().s[62]++,0);i<this.players.length;i++){cov_kgorlvdek().s[63]++;if(this.players[i].board.status==='filling'){cov_kgorlvdek().b[12][0]++;cov_kgorlvdek().s[64]++;winner=this.players[i];}else{cov_kgorlvdek().b[12][1]++;}}cov_kgorlvdek().s[65]++;this.winner=winner;cov_kgorlvdek().s[66]++;this.stop();cov_kgorlvdek().s[67]++;this.sendState();}else{cov_kgorlvdek().b[10][1]++;}}}stop(){cov_kgorlvdek().f[9]++;cov_kgorlvdek().s[68]++;this.status='finished';cov_kgorlvdek().s[69]++;clearInterval(this.interval);cov_kgorlvdek().s[70]++;this.interval=null;}sendState(){cov_kgorlvdek().f[10]++;cov_kgorlvdek().s[71]++;this.io.to(this.room).emit('gameState',this.getInfo());}getInfo(){cov_kgorlvdek().f[11]++;cov_kgorlvdek().s[72]++;return{status:this.status,players:this.players,room:this.room,mode:this.mode,owner:this.owner,winner:this.winner};}}cov_kgorlvdek().s[73]++;module.exports=Game;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdhbWUuanMiXSwibmFtZXMiOlsiUGllY2UiLCJyZXF1aXJlIiwiUGxheWVyIiwiaW8iLCJHYW1lIiwiZ2VuZXJhdGVQaWVjZVR5cGUiLCJyZG1OdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjb25zdHJ1Y3RvciIsIm93bmVyIiwicm9vbSIsIm1vZGUiLCJwbGF5ZXJzIiwicHVzaCIsInR5cGVzSW5RdWV1ZSIsInN0YXR1cyIsIndpbm5lciIsImludGVydmFsIiwiYWRkUGxheWVyIiwicGxheWVyIiwiRXJyb3IiLCJyZW1vdmVQbGF5ZXIiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJpZCIsInN0YXJ0IiwiZm9yRWFjaCIsInAiLCJib2FyZCIsImluaXQiLCJwaWVjZUluZGV4Iiwic2V0UGllY2VzIiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVTdGF0ZSIsInNlbmRTdGF0ZSIsImFsaXZlIiwibGVuZ3RoIiwidXBkYXRlIiwibmVlZFBpZWNlIiwic3RvcCIsImkiLCJjbGVhckludGVydmFsIiwidG8iLCJlbWl0IiwiZ2V0SW5mbyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLGEsb3lUQWVZO3lGQWJaLEtBQU1BLENBQUFBLEtBQUsseUJBQUdDLE9BQU8sQ0FBQyxZQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1DLENBQUFBLE1BQU0seUJBQUdELE9BQU8sQ0FBQyxhQUFELENBQVYsQ0FBWixDQUNBLEtBQU1FLENBQUFBLEVBQUUseUJBQUdGLE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBUixDQUVBLEtBQU1HLENBQUFBLElBQUssQ0FDYyxNQUFqQkMsQ0FBQUEsaUJBQWlCLEVBQUcsd0JBQzFCLEtBQU1DLENBQUFBLFNBQVMseUJBQUdDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsR0FBZ0JGLElBQUksQ0FBQ0MsS0FBTCxDQUFXLENBQVgsQ0FBM0IsQ0FBSCxDQUFmLENBRDBCLHVCQUUxQixPQUFRRixT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LENBQVEwQyxFQUFSLENBQVcsS0FBS2pDLElBQWhCLEVBQXNCa0MsSUFBdEIsQ0FBMkIsV0FBM0IsQ0FBd0MsS0FBS0MsT0FBTCxFQUF4QyxFQUNBLENBRURBLE9BQU8sRUFBRyxpREFDVCxNQUFPLENBQ045QixNQUFNLENBQUUsS0FBS0EsTUFEUCxDQUVOSCxPQUFPLENBQUUsS0FBS0EsT0FGUixDQUdORixJQUFJLENBQUUsS0FBS0EsSUFITCxDQUlOQyxJQUFJLENBQUUsS0FBS0EsSUFKTCxDQUtORixLQUFLLENBQUUsS0FBS0EsS0FMTixDQU1OTyxNQUFNLENBQUUsS0FBS0EsTUFOUCxDQUFQLENBUUEsQ0ExSFMsQyx3QkE2SFg4QixNQUFNLENBQUNDLE9BQVAsQ0FBaUI3QyxJQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgUGllY2UgPSByZXF1aXJlKCcuL1BpZWNlLmpzJyk7XG5jb25zdCBQbGF5ZXIgPSByZXF1aXJlKCcuL1BsYXllci5qcycpO1xuY29uc3QgaW8gPSByZXF1aXJlKCdzb2NrZXQuaW8nKTtcblxuY2xhc3MgR2FtZSB7XG5cdHN0YXRpYyBnZW5lcmF0ZVBpZWNlVHlwZSgpIHtcblx0XHRjb25zdCByZG1OdW1iZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBNYXRoLmZsb29yKDcpKTtcblx0XHRzd2l0Y2ggKHJkbU51bWJlcikge1xuXHRcdFx0Y2FzZSAwOlxuXHRcdFx0XHRyZXR1cm4gJ0knO1xuXHRcdFx0Y2FzZSAxOlxuXHRcdFx0XHRyZXR1cm4gJ08nO1xuXHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHRyZXR1cm4gJ0onO1xuXHRcdFx0Y2FzZSAzOlxuXHRcdFx0XHRyZXR1cm4gJ1MnO1xuXHRcdFx0Y2FzZSA0OlxuXHRcdFx0XHRyZXR1cm4gJ1onO1xuXHRcdFx0Y2FzZSA1OlxuXHRcdFx0XHRyZXR1cm4gJ0wnO1xuXHRcdFx0Y2FzZSA2OlxuXHRcdFx0XHRyZXR1cm4gJ1QnO1xuXHRcdH1cblx0fVxuXG5cdGNvbnN0cnVjdG9yKGlvLCBvd25lciwgcm9vbSwgbW9kZSkge1xuXHRcdHRoaXMuaW8gPSBpbztcblx0XHR0aGlzLm93bmVyID0gb3duZXI7XG5cdFx0dGhpcy5yb29tID0gcm9vbTtcblx0XHR0aGlzLm1vZGUgPSBtb2RlO1xuXHRcdHRoaXMucGxheWVycyA9IFtdO1xuXHRcdHRoaXMucGxheWVycy5wdXNoKG93bmVyKTtcblx0XHR0aGlzLnR5cGVzSW5RdWV1ZSA9IFtdO1xuXHRcdHRoaXMuc3RhdHVzID0gJ3N0YW5kYnknO1xuXHRcdHRoaXMud2lubmVyID0gbnVsbDtcblx0XHR0aGlzLmludGVydmFsID0gbnVsbDtcblx0fVxuXG5cdGFkZFBsYXllcihwbGF5ZXIpIHtcblx0XHRpZiAocGxheWVyIGluc3RhbmNlb2YgUGxheWVyID09PSBmYWxzZSlcblx0XHRcdHRocm93IEVycm9yKCdhcmd1bWVudCBzaG91bGQgYmUgYSBQbGF5ZXInKTtcblx0XHR0aGlzLnBsYXllcnMucHVzaChwbGF5ZXIpO1xuXHR9XG5cblx0cmVtb3ZlUGxheWVyKHBsYXllcikge1x0XHRcblx0XHRpZiAocGxheWVyIGluc3RhbmNlb2YgUGxheWVyID09PSBmYWxzZSlcblx0XHRcdHRocm93IEVycm9yKCdhcmd1bWVudCBzaG91bGQgYmUgYSBQbGF5ZXInKTtcblxuXHRcdGNvbnN0IGluZGV4ID0gdGhpcy5wbGF5ZXJzLmluZGV4T2YocGxheWVyKTtcblx0XHRpZiAoaW5kZXggPT09IC0xKVxuXHRcdFx0dGhyb3cgRXJyb3IoJ3BsYXllciBub3QgZm91bmQnKTtcblx0XHR0aGlzLnBsYXllcnMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRpZiAocGxheWVyLmlkID09PSB0aGlzLm93bmVyLmlkKSB7XG5cdFx0XHR0aGlzLm93bmVyID0gdGhpcy5wbGF5ZXJzWzBdO1xuXHRcdH1cblx0fVxuXG5cdHN0YXJ0KCkge1xuXHRcdHRoaXMuc3RhdHVzID0gJ3J1bm5pbmcnO1xuXHRcdHRoaXMudHlwZXNJblF1ZXVlWzBdID0gR2FtZS5nZW5lcmF0ZVBpZWNlVHlwZSgpO1xuXHRcdHRoaXMudHlwZXNJblF1ZXVlWzFdID0gR2FtZS5nZW5lcmF0ZVBpZWNlVHlwZSgpO1xuXHRcdHRoaXMudHlwZXNJblF1ZXVlWzJdID0gbnVsbDtcblx0XHR0aGlzLnBsYXllcnMuZm9yRWFjaCgocCkgPT4ge1xuXHRcdFx0cC5ib2FyZC5pbml0KDEwLCAyMCk7XG5cdFx0XHRsZXQgaW5kZXggPSBwLmJvYXJkLnBpZWNlSW5kZXg7XG5cdFx0XHRwLmJvYXJkLnNldFBpZWNlcyh0aGlzLnR5cGVzSW5RdWV1ZVtpbmRleF0sIHRoaXMudHlwZXNJblF1ZXVlW2luZGV4ICsgMV0pO1xuXHRcdH0pO1xuXHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZVN0YXRlKCk7XG5cdFx0XHR0aGlzLnNlbmRTdGF0ZSgpO1xuXHRcdH0sIDIwMCk7XG5cdH1cblxuXHR1cGRhdGVTdGF0ZSgpIHtcblx0XHRsZXQgYWxpdmUgPSB0aGlzLnBsYXllcnMubGVuZ3RoO1xuXHRcdHRoaXMucGxheWVycy5mb3JFYWNoKChwKSA9PiB7XG5cdFx0XHRpZiAocC5ib2FyZC5zdGF0dXMgPT09ICdmaWxsZWQnKVxuXHRcdFx0XHRhbGl2ZS0tO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHAuYm9hcmQudXBkYXRlKCk7XG5cdFx0XHRcdGlmIChwLmJvYXJkLm5lZWRQaWVjZSkge1xuXHRcdFx0XHRcdGxldCBpbmRleCA9IHAuYm9hcmQucGllY2VJbmRleDtcblx0XHRcdFx0XHRpZiAodGhpcy50eXBlc0luUXVldWVbaW5kZXggKyAxXSA9PT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0dGhpcy50eXBlc0luUXVldWVbaW5kZXggKyAxXSA9IEdhbWUuZ2VuZXJhdGVQaWVjZVR5cGUoKTtcblx0XHRcdFx0XHRcdHRoaXMudHlwZXNJblF1ZXVlW2luZGV4ICsgMl0gPSBHYW1lLmdlbmVyYXRlUGllY2VUeXBlKCk7XG5cdFx0XHRcdFx0XHR0aGlzLnR5cGVzSW5RdWV1ZVtpbmRleCArIDNdID0gbnVsbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cC5ib2FyZC5zZXRQaWVjZXModGhpcy50eXBlc0luUXVldWVbaW5kZXhdLCB0aGlzLnR5cGVzSW5RdWV1ZVtpbmRleCArIDFdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdGlmICh0aGlzLnBsYXllcnMubGVuZ3RoID09PSAxICYmIHRoaXMucGxheWVyc1swXS5ib2FyZC5zdGF0dXMgPT09ICdmaWxsZWQnKSB7XG5cdFx0XHR0aGlzLnN0b3AoKTtcblx0XHRcdHRoaXMuc2VuZFN0YXRlKCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHRoaXMucGxheWVycy5sZW5ndGggPiAxICYmIGFsaXZlID09PSAxKSB7XG5cdFx0XHRsZXQgd2lubmVyID0gbnVsbDtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICh0aGlzLnBsYXllcnNbaV0uYm9hcmQuc3RhdHVzID09PSAnZmlsbGluZycpXG5cdFx0XHRcdFx0d2lubmVyID0gdGhpcy5wbGF5ZXJzW2ldO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy53aW5uZXIgPSB3aW5uZXI7XG5cdFx0XHR0aGlzLnN0b3AoKTtcblx0XHRcdHRoaXMuc2VuZFN0YXRlKCk7XG5cdFx0fVxuXHR9XG5cblx0c3RvcCgpIHtcblx0XHR0aGlzLnN0YXR1cyA9ICdmaW5pc2hlZCc7XG5cdFx0Y2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcblx0XHR0aGlzLmludGVydmFsID0gbnVsbDtcblx0fVxuXG5cdHNlbmRTdGF0ZSgpIHtcblx0XHR0aGlzLmlvLnRvKHRoaXMucm9vbSkuZW1pdCgnZ2FtZVN0YXRlJywgdGhpcy5nZXRJbmZvKCkpO1xuXHR9XG5cblx0Z2V0SW5mbygpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0c3RhdHVzOiB0aGlzLnN0YXR1cyxcblx0XHRcdHBsYXllcnM6IHRoaXMucGxheWVycyxcblx0XHRcdHJvb206IHRoaXMucm9vbSxcblx0XHRcdG1vZGU6IHRoaXMubW9kZSxcblx0XHRcdG93bmVyOiB0aGlzLm93bmVyLFxuXHRcdFx0d2lubmVyOiB0aGlzLndpbm5lclxuXHRcdH07XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lOyJdfQ==